#!/bin/bash
set -e

case "$1" in
    remove)
        # Keep user, data, and config for potential reinstall
        echo "Armor removed but user and data preserved"
        ;;
    purge)
        # Remove everything including user and data
        echo "Purging Armor completely..."
        
        # Remove system user
        if getent passwd armor > /dev/null 2>&1; then
            deluser armor || true
        fi
        
        # Remove data directories (user confirmation should happen via apt/dpkg)
        rm -rf /var/lib/armor
        rm -rf /var/log/armor
        rm -rf /etc/armor
        
        echo "Armor completely removed"
        ;;
    upgrade|failed-upgrade|abort-install|abort-upgrade|disappear)
        # Do nothing for these cases
        ;;
    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

# Reload systemd daemon
systemctl daemon-reload || true

#DEBHELPER#
